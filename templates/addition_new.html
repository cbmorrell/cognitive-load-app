<!DOCTYPE html>
<html>
<head>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        
        h1 {
            text-align: center;
        }
        
        #container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }
        
        #question {
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        #answer {
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        #result {
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        #score {
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        input[type="text"] {
            width: 200px;
            height: 30px;
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        #summary {
            font-size: 20px;
            margin-top: 20px;
            text-align: center;
            display: none;
        }
        
        #restart-button {
            margin-top: 20px;
            display: none;
        }
    </style>
</head>
<body>
    <h1>ADDITION TASK</h1>
    <div id="container">
        <div id="question">Question: <span id="num1"></span> + <span id="num2"></span></div>
        <div id="answer">
            <form id="answer-form">
                Your Answer: <input type="text" id="user-answer">
                <button type="submit">Submit</button>
            </form>
        </div>
        <div id="result"></div>
        <div id="score">Score: <span id="correct-count">0</span>/<span id="total-count">0</span></div>
        <div id="summary"></div>
        <button id="restart-button" onclick="restartGame()">Restart Game</button>
    </div>

    <script>
        var correctCount = 0;
        var totalCount = 0;
        var startTime = Math.floor(Date.now() / 1000);
        var timer;
        
        function getRandomNumbers() {
            fetch('/get_numbers')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('num1').textContent = data.num1;
                    document.getElementById('num2').textContent = data.num2;
                });
        }
        
        function updateScore() {
            document.getElementById('correct-count').textContent = correctCount;
            document.getElementById('total-count').textContent = totalCount;
        }
        
        function updateResultMessage(isCorrect) {
            var resultElement = document.getElementById('result');
            resultElement.textContent = isCorrect ? 'Correct!' : 'Wrong!';
            resultElement.style.color = isCorrect ? 'green' : 'red';
        }
        
        function resetQuiz() {
            document.getElementById('user-answer').value = '';
            document.getElementById('result').textContent = '';
            getRandomNumbers();
        }
        
        function handleFormSubmit(event) {
            event.preventDefault();
            var userAnswer = parseInt(document.getElementById('user-answer').value);
            var num1 = parseInt(document.getElementById('num1').textContent);
            var num2 = parseInt(document.getElementById('num2').textContent);
            var expectedSum = num1 + num2;
            
            totalCount++;
            
            if (userAnswer === expectedSum) {
                correctCount++;
                updateResultMessage(true);
            } else {
                updateResultMessage(false);
            }
            
            updateScore();
            setTimeout(resetQuiz, 2000); // Wait 2 seconds before resetting the quiz
            
            if (totalCount === 10) {
                clearInterval(timer);
                showSummary();
            }
        }
        
        function startTimer() {
            timer = setInterval(function() {
                var currentTime = Math.floor(Date.now() / 1000);
                var elapsedTime = currentTime - startTime;
                
                if (elapsedTime >= 100) {
                    clearInterval(timer);
                    showSummary();
                }
            }, 1000);
        }
        
        function showSummary() {
            var accuracy = (correctCount / totalCount) * 100;
            var summaryElement = document.getElementById('summary');
            summaryElement.style.display = 'block';
            summaryElement.style.fontWeight = 'bold';
            
            if (accuracy >= 90) {
                summaryElement.textContent = 'Outstanding!';
                summaryElement.style.color = 'green';
            } else if (accuracy >= 70) {
                summaryElement.textContent = 'Good!';
                summaryElement.style.color = 'blue';
            } else if (accuracy >= 30) {
                summaryElement.textContent = 'Satisfactory!';
                summaryElement.style.color = 'orange';
            } else {
                summaryElement.textContent = 'Poor!';
                summaryElement.style.color = 'red';
            }
            
            document.getElementById('restart-button').style.display = 'block';
        }
        
        function restartGame() {
            correctCount = 0;
            totalCount = 0;
            startTime = Math.floor(Date.now() / 1000);
            document.getElementById('summary').textContent = '';
            document.getElementById('summary').style.display = 'none';
            document.getElementById('summary').style.color = '';
            document.getElementById('restart-button').style.display = 'none';
            updateScore();
            resetQuiz();
            startTimer();
        }
        
        document.getElementById('answer-form').addEventListener('submit', handleFormSubmit);
        getRandomNumbers();
        startTimer();
    </script>
</body>
</html>
