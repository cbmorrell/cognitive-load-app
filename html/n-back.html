<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>N-back Test</title>
        <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.2.3/dist/lux/bootstrap.min.css" rel="stylesheet">
    </head>

    <body>
        <h1 class="text-center">N-back Test</h1>
        <p class="text-center">
            This is a cognitive load task known as the n-back test. A new letter will be shown every couple of seconds. If the current letter matches the letter
            n characters back, please select the 'Match' button.
        </p>
        <div class="card text-white bg-primary mb-3 text-center" style="max-width: 10rem; margin: auto;">
            <div class="card-header">Current letter:</div>
            <div class="card-body" id="character-display">X</div>
            <button class="text-center" onclick="checkMatch()">Match</button>
        </div>

        <script>
            /*
            n-back test inspired by https://n-back.irockbunnylab.com/.
            Every couple of seconds, show a new letter. The user should select the 'match' button once the current character matches the character 'n-back',
            where n is the difficulty level of the test.
            */

            // Not a native queue implementation in JS. Probably just use an array or something or use a simple class implementation
            let characterQueue = [];  // store sequence of characters shown to user
            let difficultyLevel = 1;  // level of difficulty (n in n-back)
            const possibleCharacters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";    // possible characters to display to user
            const intervalTime = 2500;  // amount of time between generation of new characters (milliseconds)

            function generateNewCharacter() {
                if (characterQueue.length >= difficultyLevel + 1) {
                    // If there are n characters in the queue, dequeue. This is done to make sure that unnecessary characters aren't stored over time.
                    characterQueue.shift()
                }

                // Add another character to the queue
                const randomCharacter = possibleCharacters[Math.floor(Math.random() * possibleCharacters.length)]
                characterQueue.push(randomCharacter)

                // Display new character
                document.getElementById("character-display").innerText = randomCharacter;
            }

            function checkMatch() {
                // Check if current character matches character n-back (i.e., the first character in the queue matches the last)
                const previousCharacter = characterQueue[characterQueue.length - difficultyLevel - 1];
                const currentCharacter = characterQueue[characterQueue.length - 1];
                console.log(previousCharacter === currentCharacter);
            }
            
            setInterval(() => {
                generateNewCharacter()
                checkMatch()
            }, intervalTime);
            
        </script>
    </body>
</html>